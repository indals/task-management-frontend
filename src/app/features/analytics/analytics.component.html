<!-- Analytics Dashboard -->
<div class="analytics-container">
  <div class="analytics-header">
    <div class="header-content">
      <h1 class="analytics-title">Analytics Dashboard</h1>
      <p class="analytics-subtitle">Team performance insights and metrics</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-primary" (click)="refreshData()" [disabled]="isLoading">
        <span class="icon">ðŸ”„</span>
        Refresh
      </button>
      <button class="btn btn-accent" (click)="exportReport()">
        <span class="icon">ðŸ“¥</span>
        Export Report
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Loading analytics data...</p>
  </div>

  <!-- Analytics Content -->
  <div *ngIf="!isLoading" class="analytics-content fade-in">
    
    <!-- Key Metrics Cards -->
    <div class="metrics-grid">
      <div class="metric-card hover-card">
        <div class="card-content">
          <div class="metric-header">
            <span class="metric-icon team">ðŸ‘¥</span>
            <span class="metric-label">Team Members</span>
          </div>
          <div class="metric-value">{{ teamMetrics.totalEmployees }}</div>
        </div>
      </div>

      <div class="metric-card hover-card">
        <div class="card-content">
          <div class="metric-header">
            <span class="metric-icon tasks">ðŸ“‹</span>
            <span class="metric-label">Active Tasks</span>
          </div>
          <div class="metric-value">{{ teamMetrics.activeTasks }}</div>
        </div>
      </div>

      <div class="metric-card hover-card">
        <div class="card-content">
          <div class="metric-header">
            <span class="metric-icon completion">âœ…</span>
            <span class="metric-label">Completion Rate</span>
          </div>
          <div class="metric-value">{{ teamMetrics.completionRate }}%</div>
        </div>
      </div>

      <div class="metric-card hover-card">
        <div class="card-content">
          <div class="metric-header">
            <span class="metric-icon average">ðŸ“ˆ</span>
            <span class="metric-label">Avg Tasks/Employee</span>
          </div>
          <div class="metric-value">{{ teamMetrics.avgTasksPerEmployee }}</div>
        </div>
      </div>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <div class="charts-row">
        <!-- Team Performance Chart -->
        <div class="chart-card">
          <div class="card-header">
            <h3 class="card-title">Team Performance Overview</h3>
            <p class="card-subtitle">Current task distribution</p>
          </div>
          <div class="card-content">
            <div class="chart-container">
              <canvas id="teamPerformanceChart" width="400" height="300"></canvas>
            </div>
          </div>
        </div>

        <!-- Task Trends Chart -->
        <div class="chart-card">
          <div class="card-header">
            <h3 class="card-title">Task Trends</h3>
            <p class="card-subtitle">Last 7 days</p>
          </div>
          <div class="card-content">
            <div class="chart-container">
              <canvas id="taskTrendsChart" width="400" height="300"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="charts-row">
        <!-- Project Progress Chart -->
        <div class="chart-card">
          <div class="card-header">
            <h3 class="card-title">Project Progress</h3>
            <p class="card-subtitle">Current projects status</p>
          </div>
          <div class="card-content">
            <div class="chart-container">
              <canvas id="projectProgressChart" width="400" height="300"></canvas>
            </div>
          </div>
        </div>

        <!-- Workload Distribution Chart -->
        <div class="chart-card">
          <div class="card-header">
            <h3 class="card-title">Workload Distribution</h3>
            <p class="card-subtitle">By department</p>
          </div>
          <div class="card-content">
            <div class="chart-container">
              <canvas id="workloadDistributionChart" width="400" height="300"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Data Tables Section -->
    <div class="tables-section">
      <div class="tables-row">
        <!-- Top Performers Table -->
        <div class="table-card">
          <div class="card-header">
            <h3 class="card-title">Top Performers</h3>
            <p class="card-subtitle">This month's top contributors</p>
          </div>
          <div class="card-content">
            <table class="performers-table">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>Name</th>
                  <th>Tasks Completed</th>
                  <th>Completion Rate</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let element of topPerformers; let i = index">
                  <td>{{i + 1}}</td>
                  <td>{{element.name}}</td>
                  <td>{{element.tasksCompleted}}</td>
                  <td>
                    <span class="completion-rate" 
                          [class.high]="element.completionRate >= 90" 
                          [class.medium]="element.completionRate >= 80 && element.completionRate < 90"
                          [class.low]="element.completionRate < 80">
                      {{element.completionRate}}%
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Projects Overview Table -->
        <div class="table-card">
          <div class="card-header">
            <h3 class="card-title">Projects Overview</h3>
            <p class="card-subtitle">Current project status</p>
          </div>
          <div class="card-content">
            <table class="projects-table">
              <thead>
                <tr>
                  <th>Project</th>
                  <th>Progress</th>
                  <th>Status</th>
                  <th>Due Date</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let element of projectsOverview">
                  <td>{{element.name}}</td>
                  <td>
                    <div class="progress-container">
                      <div class="progress-bar">
                        <div class="progress-fill" [style.width.%]="element.progress"></div>
                      </div>
                      <span class="progress-text">{{element.progress}}%</span>
                    </div>
                  </td>
                  <td>
                    <span class="status-chip" 
                          [class.on-track]="element.status === 'On Track'"
                          [class.ahead]="element.status === 'Ahead'"
                          [class.behind]="element.status === 'Behind'">
                      {{element.status}}
                    </span>
                  </td>
                  <td>{{element.dueDate | date:'MMM d, y'}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>